<!DOCTYPE html>
<html><head><title>Another Code Battle Royale</title></head><body><article><h2>Another Code Battle Royale</h2><time>November 15, 2010</time><div><p>My brother and I are programmers. This must be discreetly understood or no good will come of the story I am about to regale. Every <a href="http://dxprog.com/entry/a-coding-compo/">once and again</a>, we&#39;ll embark on a coding competition. Last time was a game, this time a chat client. My weapon of choice was various web languages (PHP and JS for the programatic stuff) and his was C++. Arguably, I had an advantage.</p>
<p>Even though I was able to bypass the whole sockets layer, I did set a rule for myself: I could not resort to using a transactional database (i.e. MySQL). Granted, I didn&#39;t foresee any issues as I had the power of APC caching on my side. It turned out that this would be what I fought with most and, eventually, just give up on.</p>
<p>For whatever reason, despite the fact that apc_store was returning success on caching an object, it would not persist. A quick call to apc_exists immediately after the store command with the same cache key confirmed this. I went round and round with this issue. Sometimes the object would persist for one or two sessions but ultimately would up be dropped. I read somewhere that storing an array of objects could cause issues (which I was doing), so I serialized the bitch before caching. No dice.</p>
<p>In the end I said &quot;screw it&quot; and just created my own disk-based caching model. I decided to take the whole thing a little further and account for cache collisions (two instances accessing the cache at the same time) which may or may not work. The only reason I even bothered was because I have an ID variable that needs to iterate for every single chat posted and sought to avoid two scripts running simultaneously and writing an erroneous value (a point that was raised in some fashion during my <a href="http://dxprog.com/entry/the-digg-debacle/">Digg interview</a>.</p>
<p>So, two hours after the initial one we&#39;d allotted for the competition, I wound up victorious. While not glamorous, my chat client does indeed work: <a href="http://dev.dxprog.com/quickChat">Live Demo</a> - <a href="http://dxprog.com/files/quickChat.zip">Source</a></p>
<p>What of my brother&#39;s program? Well, let&#39;s just say the computers weren&#39;t talking too nice and the program kept crashing.</p>
<p>Victory is mine!</p>
</div></article></body></html>