<!DOCTYPE html>
<html><head><title>Archives - Page 129</title><link rel="stylesheet" type="text/css" href="static/css/index.css"/></head><body><section class="article-list"><article><h2>JsLive - Progress Report and Screenshots</h2><time>April 2, 2011</time><div><p>After Friday&#39;s more <a href="http://dxprog.com/entry/its-like-nes-emulator-dev-all-over">technical post</a>, today I strive to show actual progress on what I&#39;ve deemed to call JsLive.</p>
<p>Today I got a basic graphics stack implemented and working, though it&#39;s riddled with its fair share of bugs and is certainly nowhere near being feature complete (environmental objects, animation, etc). However, I&#39;m having no problem running through entire scenario files having completed the first day in Kanon with no problems. But, on to the screenshots (note - the following where all taken in Chrome 12.0.712.0 dev)!</p>
<p><img src="http://images.dxprog.com/blog/jslive_ss1.jpg" alt="" title="Tell him, Nayuki!"></p>
<p><img src="http://images.dxprog.com/blog/jslive_ss2.jpg" alt="" title="Example of a decision point within the game."></p>
<p><img src="http://images.dxprog.com/blog/jslive_ss3.jpg" alt="" title="An astute observation."></p>
<p>Because my ultimate goal is to have this working for mobile platforms, I&#39;ve been testing against my iPhone (at least until I&#39;ve got an iPad). Here&#39;s some screens:</p>
<p><img src="http://images.dxprog.com/blog/jslive_ss4.jpg" alt="" title="I even gave it a schwanky icon."></p>
<p><img src="http://images.dxprog.com/blog/jslive_ss5.jpg" alt="" title="Lookin&#39; fine!"></p>
<p>I haven&#39;t yet implemented scaling to the device&#39;s screen size (the screen above was pinch-zoomed to the correct size).</p>
<p>I&#39;m okay with the graphics stack for the time being, so I&#39;m going to begin work on one of the last major hurdles with jumping between different scenario files. I&#39;m hoping to have an open beta up soon and hopefully get some feedback from people with various devices.</p>
<p>Stay tuned!</p>
</div></article><article><h2>It&#x27;s like NES emulator dev all over</h2><time>April 2, 2011</time><div><p><img src="http://images.dxprog.com/blog/jslive.jpg" alt="" title="Yes, my pretties. You will soon be mine!"></p>
<p>Somewhere around the time I began working at Wal-Mart, I thought it would be a nice challenge to write an <a href="http://dxprog.com/entry/one-week-anniversary/">NES emulator</a>. One of these days I&#39;ll release my mess of source code for that, but it was probably one of the most awesome programming challenges I&#39;ve ever undertaken. So, why am I waxing nostalgic about this project from nearly six years ago? (warning - there&#39;s technical programmy talk inside)[break]</p>
<p>Well, you may have garnered from <a href="http://dxprog.com/entry/2010-reviews-finale/">posts past</a> that I may or may not have played visual novels of some anime shows I&#39;ve seen (I have). In particular, those would be Clannad and Kanon. I&#39;ve not fully completed either of these games because, let&#39;s face it, hunching over a computer reading gratuitous amounts of text is tiring. However, I believe the visual novel format would work well on tablet PCs. Interestingly enough, both of these games as well as most things from Key/VisualArts run on a system called <a href="http://haven.parodius.com/formats/#reallive">RealLive</a>. The actual scenario file for each game is a custom scripting language unique to the RealLive engine. My goal is to make an HTML5 based interpreter so I can make these games available to mobile platforms.</p>
<p>This is where the parallel to NES emulators come: I have to reconstruct the functions, logic, etc. that the RealLive system has in JavaScript and HTML. However, whereas emulating a 6502 is just a series of super basic functions (add the accumulator to the X register and jump if the carry flag was set), this is a whole new level of complexity. It&#39;s more akin to writing a C compiler, really. Take this for example:</p>
<p>[code=Kepago]strS[1900] += strS[1900][/code]</p>
<p>Now, in human terms this is pretty simple: add the value of strS[1900] to itself. However, getting a computer to understand this behaviour is something quite different. After a little googling, this is apparently an operation called lexical analysis. My solution is actually a two step process:</p>
<ol>
<li>A PHP script parses the decompiled source code and converts the above into a JSON format like so:</li>
</ol>
<p>[code=JSON]{&quot;action&quot;:&quot;assign&quot;,&quot;name&quot;:&quot;strS[1900]&quot;,&quot;value&quot;:&quot;strS[1901]&quot;,&quot;operation&quot;:&quot;+=&quot;,&quot;ln&quot;:18487}[/code]</p>
<p>Name is what&#39;s on the left hand side of the equation, operation is the operator and value is the right hand side of the operation.</p>
<ol>
<li>Now. that format was setup before I realized that true language parsing was going to be required, so at this point my JavaScript is reconstructing the original equation from those variables. It passes these off to a function called &quot;evaluateExpression&quot; which figures out what&#39;s a string, variable, function, number, operator, etc. and remaps everything so that it points to internal functions and variables. This string would then look like this:</li>
</ol>
<p>[code=JavaScript]variables[&quot;strS[1900]&quot;] += variables[&quot;strS[1900]&quot;][/code]</p>
<p>This string is then run through <em>eval</em> and is parsed by JS natively (allowing me to cop out of writing the really difficult stuff).</p>
<p>So, at this point, I have most all of the branching and logic functions working correctly (as far as I&#39;m aware) in addition to the sound and music (super simple stuff). Now I&#39;m working towards getting the core graphics functions in place which should get me pretty close to a playable state.</p>
<p>It&#39;s been a long time since I&#39;ve had a programming project that&#39;s been this enjoyable and branched me off into new territory. I, for one, welcome it.</p>
</div></article></section></body></html>