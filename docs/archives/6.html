<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Archives - Page 6</title><link rel="stylesheet" type="text/css" href="http://staticr.dxprog.com/static/css/index.css"/></head><body><section class="article-list"><article><h2><a href="http://staticr.dxprog.com/entry/fun-with-load-balancers-and-running-on-lean-disk-space">Fun with Load Balancers and Running on Lean Disk Space</a></h2><time>March 29, 2015</time><div><p>A while back, I spun up a new server and threw a load balancer on top of it and my existing server. The primary reason at the time was to allow cdn.awwni.me to continue to run while Linode performed some mandatory maintenance on the original server (we&#39;ll call it &quot;Chitoge&quot;). The size of that directory at the time was somewhere around 100GB; my new server (we&#39;ll call that one &quot;Taiga&quot;) has something like 20GB of total space. Obviously, I couldn&#39;t clone from Chitoge to Taiga, so I got a little clever. Using some fun around the hosts file, the nginx site config, and a small <a href="https://github.com/dxprog/rbcdn">PHP script</a>, when a file can&#39;t be found locally, it&#39;d be retrieved from the Amazon S3 store I use as long term backup. S3 is slow, though, so I later changed it to pull directly from Chitoge. This helped both with speed and didn&#39;t count against traffic since internal network traffic is free. In a bout of laziness, instead of opening a connection to that server via IP and hand massaging the &#39;Host&#39; header of the request (or mounting some sort of file share), I just host overrode cdn.awwni.me on Taiga to point to Chitoge. Everything worked great.</p>
<p>Last night, knowing that I was soon to exhaust space on Chitoge (a thing that has happened on more than one occasion), I decided to convert it over to the same setup as Taiga. This would allow me to kill dozens of gigabytes of locally stored images and extend the life of my server plan at least a couple of years. Knowing that I was now deleting Taiga&#39;s source of truth image store, I changed up the script to check from a pool of servers; first try a local server, then if that fails, go to AWS. That worked fine and, while I was setting this script up on Chitoge, I decided that it should check against Taiga just in case it had a copy before wasting time downloading from AWS.</p>
<p>I got everything set up and started deleting old image files. Everything seemed fine, so I let the deleting continue and went to bed.</p>
<p>When I woke up, I was greeted by many messages in my reddit inbox saying that images were experiencing 50x errors. My initial thought was that I was saturating the CPU/connection with that long running process, so I killed it. I was unable to repro any errors, so I went on my merry way... until somebody new complained. Well, fuck...</p>
<p>To make a long story short, because I had pointed each server to each other, I was creating an infinite network loop whenever an non-local image was requesting. Here it is in traffic logs:</p>
<p>[User Request -&gt; Taiga] GET /the_image.jpg
Doesn&#39;t exist locally. Retrieving from first server in pool: <a href="http://cdn.awwni.me/the_image.jpg">http://cdn.awwni.me/the_image.jpg</a> (Forced pointing to Chitoge)
[Taiga -&gt; Chitoge] GET /the_image.jpg
Doesn&#39;t exist locally. Retrieving from first server in pool: <a href="http://cdn.awwni.me/the_image.jpg">http://cdn.awwni.me/the_image.jpg</a> (Forced pointing to Taiga)
[Chitoge -&gt; Taiga] GET /the_image.jpg
Doesn&#39;t exist locally. Retrieving from first server in pool: <a href="http://cdn.awwni.me/the_image.jpg">http://cdn.awwni.me/the_image.jpg</a></p>
<p>So, basically that until the scripts start timing out. Now, in a normal infinite loop, you kill your own process but, generally, should be safe from affecting others. However, here, every time there&#39;s a new request, that&#39;s potentially a new instance of PHP being spun up because the other instances are deadlocked waiting for data. So, eventually, the entire chain collapses and you start getting orangereds in your reddit inbox.</p>
<p>In the end, I still have Taiga sourcing from Chitoge since all image uploads go directly there and, generally, Chitoge will have a copy of the file. Chitoge will always take the AWS hit when a file doesn&#39;t exist to avoid this loop scenario. There are many ways I could avoid this scenario entirely, but for now, this set up is getting the job done.</p>
</div></article><article><h2><a href="http://staticr.dxprog.com/entry/stoned-my-experiences-with-marijuana">Stoned - My Experiences With Marijuana</a></h2><time>March 22, 2015</time><div><p>I also considered naming this “The Post My Mother Doesn’t Want to Read”, but that’d be about when I killed that kid in kindergarten. Maybe some other day…</p>
<p>Growing up in a highly conservative Catholic family, it was ingrained into me from an early age that drugs are bad, m’kay. Anybody using or trying to give you these substances were people you generally wanted to avoid. As an interesting aside, alcohol consumers were not subject to the same stigma. But, be that as it was, I carried on through most of my life with a contempt for such things. This feeling didn’t waver, even as I prepared to move to California and the joke running rampant was “huhhuhhuh, you gonna get your weed card?”.</p>
<p>I’m not sure exactly when that sentiment began to change. Through peripheral consumption of various research papers that were being published about the effects of THC on the human body, I knew that marijuana was, in general, less harmful than most recreational drugs and even alcohol. That probably softened the attitude towards the drug itself, but did little to change my view of the consumers and culture built around it. Adding to that, my only knowledge of consumption methods was via burning the leaf. “Less harmful” be damned if you’re still pumping your lungs full of carcinogens.</p>
<p>My perception of the drug and its effect on consumers probably actually changed at about the same time. I began to find out that a lot of the people I held in high regard were consumers, people I never would have suspected were it not pointed out to me. There was, of course, a lot of cognitive dissonance upon hearing this because, in my world view, if you smoke marijuana, you become a couch-bound bum who just smokes and says “duuuuude” a lot. In that same conversation, “edibles” were mentioned, and not the home baked weed brownies. Chocolate bars made by companies who had to adhere to the standards of a government body in order to sell their wares through legal venue.</p>
<p>That, I think, was the tipping point. THC could be made available to me in a form that was easily consumed and easily metered. And so, about a year ago, I tried a very small bit of marijuana laced chocolate just to test the waters. The outcome? Well, I was having trouble determining that through the more immediate feeling of being tipsy that evening. In retrospect, the profound tiredness I felt a couple hours later was the effect of the chocolate.</p>
<p>With the gates having been opened, and at the time thinking I had not felt the effects, I allowed myself a little more experimentation. Of course, this had some upper limits. Absolutely no inhalation of burned weed; being that I have asthma, this would not be good. Also, see above about carcinogens. Really, that left me with a couple of options: try a larger dose of edibles or vaping. And I tried both, with differing effects. Edibles took a very long time to set in and lingered for hours. Vaping was much faster to feel the effects, but shorter lived. I decided that if I wanted to continue using marijuana, these would be the two vehicles of delivery.</p>
<p>In May of last year, I decided to get my card. Or, in my case, I opted to not buy the card and just got the paper. This entailed a visit to a doctor (I want to put quotes, but she was a licensed M.D.) with complaints of some ailment. I said something about migraines, my mother used to have them, had tried herbal something or others, blah and etc. Doctor didn’t blink an eye (she knew I was lying) and, after signing the paper, we spent more time discussing her grandfather who used to live in Bartlesville and had died recently than any topic for why I was there. It was an odd experience for sure.</p>
<p>Thus, through the last year, I’ve been a fairly light user of the product. I eventually gave up on edibles because it basically destroys an entire day. Also, I was beginning to experience bad indigestion, the culmination of which involved me throwing up on a train about a mile from my stop. Of course, that could have also been the dozen-ish drinks I had that night (it was a good birthday). There have been times when I’ve gone without, both due to circumstances or intentional “quitting”. The “quitting” was because I believed that the vape pen I was using was causing the back of my throat to become and stay raw due to heat. I stopped and it went away, so there’s a high potential for correlation (to be fair, that particular pen was later removed from the market). Marijuana is a non-addictive drug, so I never feel like I <em>need</em> it. However, like anything, one can become psychologically addicted to the high itself. I’d be remiss if I said there wasn’t a little bit of that going on.</p>
<p>Today, I treat marijuana in basically the same way I treat alcohol. If I’m to use it, driving and most outside activities are banned. Unlike alcohol, I will use it by myself outside of social situations, but generally only before bed as it helps calm my mind for sleep.</p>
<p>Going forward, I’ve already decided not to renew my card this year. There are a few reasons, the first of which is that I don’t want to have to make another “doctor visit”. Secondly, it’s obviously cheaper to drop this. Granted, because I’m such a light user, the cost of a year’s worth of marijuana is still less than a handful of average nights of bar hopping. I will probably continue to partake in social settings, but I do not feel the need to have it on my person or in my home.</p>
<p>The takeaway from all this is that there are a lot misconceptions and old feelings about marijuana and its users. Becoming stoned will probably not turn a person into a stereotypical stoner unless that person was already susceptible to such things, as can be expected with almost anything. I still don’t like the culture, nor do I like the smell, but I think if one wants to argue about the negatives of using marijuana, one should also consider alcohol and cigarettes, both of which are (mostly) socially acceptable, legal, and much worse for a person’s physical well-being.</p>
</div></article><article><h2><a href="http://staticr.dxprog.com/entry/one-good-turn">One good turn</a></h2><time>February 14, 2015</time><div><p>In my previous post, I mentioned the little &quot;micro list&quot; thing my mom is currently doing on her blog. Among these was a <a href="http://mom28kids.com/2015/02/february-five-favorites-edition/">favorites list</a>. Noticing that she had added a row for video games, I snarkily suggested she should have &quot;favorite TNG character&quot;. To her credit, she devoted the <a href="http://mom28kids.com/2015/02/february-five-12/">entire next post</a> to the topic of Next Generation. It&#39;s moments like these when I consciously consider the fact that my mom has a bit of a nerdy streak which is pretty cool.</p>
<p>But, enough of that, given that she went through the trouble of constructing that list, I feel it&#39;s only right that I do the same. So, following her parameters, here is mine:</p>
<p><strong>1. Favorite Character</strong> - Gonna have to go with Picard on this one. How can you not respect the guy who is essentially a role model for humanity? Following closely behind would be Q, Data, and Riker (in no particular order).</p>
<p><strong>2. Favorite Episode</strong> - Much to my mom&#39;s chagrin, I can&#39;t not give this award to <a href="http://en.memory-alpha.org/wiki/Cause_and_Effect_%28episode%29">Cause and Effect</a>. I believe it&#39;s been mentioned before, but I love time travel stories and time loops in particular are a guilty pleasure of mine. On a funny aside, the first Google result for &quot;enterprise keeps exploding&quot; is the Wiki entry for this episode.</p>
<p><strong>3. Least Favorite Character</strong> - You thought I was going to say Pulaski, didn&#39;t you mother? Well, despite the fact that I cannot stand her elitist attitude and the way she treats data, she&#39;s only number two in that regard. No, this coveted award goes to Tasha Yar, the overly emotional, too bull-headed security officer that preceded Worf. Her death is one of the shining moments of the series.</p>
<p><strong>4. Favorite Doctor</strong> - I don&#39;t have much to say about Lwaxana Troi (though, I do enjoy the episodes she&#39;s in), but I do have words for the various doctors in the series, my favorite being (drumroll) the Doctor! Sure, the actual TV series only had Pulaski and Crusher (of two, I prefer the latter), but the good ol&#39; EMH makes a wonderful yet brief appearance in First Contact making him eligible for this list. You can&#39;t not love his dickish, self-serving attitude and, as a main character on Voyager, was given much more time to be fleshed out as a character.</p>
<p><strong>5. On the topic of Q</strong> - Who doesn&#39;t love Q? He&#39;s such an asshole, but a highly entertaining one (see above about the Doctor). Q episodes always tend to bring out the more interesting topics, such as &quot;how would you relive your life given the chance&quot;? He also introduced the Borg, which is kind of a big deal.</p>
<p>Okay, I have geeked out about Trek for long enough. I should run to the store to pick up ingredients for turkey soup. Should be a hoppin&#39; good time.</p>
</div></article><article><h2><a href="http://staticr.dxprog.com/entry/i-am-thief-watch-me-steal">I am thief, watch me steal</a></h2><time>February 5, 2015</time><div><p>Taking a page from the <a href="http://mom28kids.com/2015/02/february-five-4/">tiny little blog posts</a> my mom is doing right now, I&#39;m going to steal that idea.</p>
<h2 id="february-5th-2015">February 5th, 2015</h2>
<ol>
<li>Went to work today</li>
<li>Larger breakfast because everything looked good.</li>
<li>Made coffee. Then drank it</li>
<li>Refactored touch code to be more modular. Such tedium, decent results.</li>
<li>What the fuck, Nick? I get that it&#39;s nutella day, but I&#39;m trying to lose weight.</li>
<li>Doubled my morning water intake because I was thirsty</li>
<li>Salad with tuna for lunch. Such sadness</li>
<li>Leave work early to await my piano delivery</li>
<li>Oh, it&#39;s already here. And the stand is here too</li>
<li>&quot;Hey, guy. My name is Mr. Headache. Let me throb for a while&quot;.</li>
<li>Fuck you, Mr. Headache.</li>
<li>Still waiting for the piano pedals, but it&#39;s good to be playing things again.</li>
</ol>
<p>That almost felt therapeutic.</p>
</div></article><article><h2><a href="http://staticr.dxprog.com/entry/2014-microretrospectives-programming">2014 Micro Retrospectives - Programming</a></h2><time>January 4, 2015</time><div><p>Getting back to that thing I was doing, today I&#39;ll cover last year&#39;s coding efforts. And what efforts those were. Actually, I think 2014 might be my most active year ever. Just going by GitHub, I totaled over 670 commits. Of course, that doesn&#39;t include anything I did at work (and there was certainly a lot of that). So what exactly happened last year?</p>
<h2 id="redditbooru-v2">RedditBooru v2</h2>
<p>This is <a href="http://dxprog.com/entry/systems-architecture-in-the-unknown/">pretty</a> well <a href="http://dxprog.com/entry/redditbooru-v2-postmortem/">documented</a>. January was spent rewriting basically everything as I attempted to port RedditBooru to nodejs. Then, when that didn&#39;t pan out how I wanted, went back to the original PHP stack with major modifications to the existing codebase. The new feature set in v2 wasn&#39;t the huge success I expected it to be (though, my bandwidth nearly doubled overnight). Indeed, views have been steadily dropping, though I think this is partially due to better RES integration that came along. Still, 875k page views by 214k unique users is pretty good and more than I would have anticipated anything I&#39;d ever create would do. But, that doesn&#39;t even begin to compare to...</p>
<h2 id="anime-bracket">Anime Bracket</h2>
<p>Some interesting stuff happened here (that is actually pending a full write up). In August, a user on the anime subreddit contacted me about using the awwnime bracket site for a bracket he wanted to do. I said yes, pulled some code strings, and let him on his merry way. Long story short, that bracket garnered over 1 million page views and 2.5 million votes by 24k registered users. Here&#39;s a fun little image showing the difference between that bracket and the one I usually run in the fall:</p>
<p><img src="http://i.imgur.com/Jnda7fE.jpg" alt="" title="That tall peak is 45k users in one day"></p>
<p>That kickstarted an effort by me to make the bracket accessible to anybody (because it has also proved to be financially sustainable). Indeed, as I write this, I&#39;m taking a break from <a href="http://beta.brakk.it/">working on the new site</a>. But, more details on that later.</p>
<h2 id="everything-else">Everything Else</h2>
<p>As usual, those two projects continue to be my main concern while not at work. However, that&#39;s not all I&#39;ve done. There was the aforementioned contributions to RES updating support for RedditBooru albums. There was also the work I did on the <a href="https://www.youtube.com/watch?v=PoghOn8Abs8">awwnime bracket app</a>. I also did some work around my <a href="https://github.com/dxprog/HueHueHueNET/tree/master/HueController">Hue lights</a> and a couple of other <a href="https://github.com/dxprog/HedonismSlackBot">trifling</a> <a href="https://github.com/dxprog/ScreensAgainstHumanity">things</a> that didn&#39;t gain traction. Of course, that&#39;s not including the stuff that I don&#39;t commit (and I do a lot of small scripts just to help out with day-to-day life).</p>
<p>Alright, so there&#39;s another post.</p>
</div></article><div class="paging"><a href="http://staticr.dxprog.com/archives/7.html" class="paging__link paging__link--next">Earlier Posts</a><a href="http://staticr.dxprog.com/archives/5.html" class="paging__link paging__link--previous">Later Posts</a></div></section></body></html>