<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Archives - Page 10</title><link rel="stylesheet" type="text/css" href="http://staticr.dxprog.com/static/css/index.css"/></head><body><section class="rollup-page"><section class="intro-bar intro-bar--horizontal"><img src="http://staticr.dxprog.com/static/images/me.jpg" alt="Matt Hackmann" class="intro-bar__photo"/><h1 class="intro-bar__header"><span class="intro-bar__name intro-bar__name--first">Matt</span><span class="intro-bar__name intro-bar__name--last">Hackmann</span></h1><h2 class="intro-bar__subhead">The thoughts and goings-on of some programmer dude.</h2><nav class="intro-bar__social-nav"><ul class="social-links"><li class="social-links__item"><a class="social-links__link social-links__link--rss" target="_blank" href="http://feeds.feedburner.com/dxprog">RSS Feed</a></li><li class="social-links__item"><a class="social-links__link social-links__link--github" target="_blank" href="https://github.com/dxprog">GitHub</a></li><li class="social-links__item"><a class="social-links__link social-links__link--twitter" target="_blank" href="https://twitter.com/dxprog">Twitter</a></li><li class="social-links__item"><a class="social-links__link social-links__link--linkedin" target="_blank" href="https://www.linkedin.com/in/mhackmann">LinkedIn Profile</a></li></ul></nav></section><section class="article-list"><article class="post"><header class="post__header"><h1 class="post__title"><a href="http://staticr.dxprog.com/entry/getting-around-the-iron-curtains">Getting Around the Iron Curtains</a></h1><time class="post__published">February 23, 2014</time></header><div class="post__content"><p>Last week, a friend clued me into CloudFlare, a CDN service that also somehow has a free tier with unlimited bandwidth. This played right into my fears of hitting the 4TB bandwidth ceiling on my current hosting tier. Put into perspective, that&#39;s pretty close to all the digital storage I have available in my apartment. Also, it quells the fears that users on the other side of the pond are getting subpar download times. So, with minimal weighing of the consequences, I flipped everything over. And, lo and behold, it worked!</p>
<p>Almost...</p>
<p>You see, some countries and ISPs think that blocking shit on the internet is a really great idea. I&#39;m not going to go on a political rampage right now because that&#39;s not my style, but when you&#39;re getting messages about users unable to download content from your hosting due to these reasons, it&#39;s more than a little irritating. But, goddammit, I&#39;m a programmer and there had to be a solution that&#39;d get me the best of both worlds without shelling out additional money.</p>
<p>After disabling the caching layer on that subdomain (cdn.awwni.me), I began weighing my options. Somehow I needed to find out if a particular user had the ability to talk to CloudFlare (now working through licdn.awwni.me). Most views were going to be served straight out of reddit.com, but I had a couple of attack vectors: the redditbooru.com main site, which is hit often for people doing repost checks or looking at albums that have been posted to reddit, and the RedditBooru browser extensions. The former was going to be the easiest to tinker with (so I thought) and affect the most people.</p>
<p>Since I had a way to test availability, I needed to actually perform the test itself. What I devised was an iframe that would be loaded on every page of RedditBooru. It would load the following script:</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://licdn.awwni.me/cdncheck.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<pre><code class="lang-javascript"><span class="hljs-comment">// If this page has managed to load, go ahead and set the CDN cookie to expire on my 100th birthday</span>
<span class="hljs-keyword">var</span> date = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'2086/6/8'</span>)).toGMTString();
<span class="hljs-built_in">document</span>.cookie = <span class="hljs-string">'use_cdn=true; expires='</span> + date;
</code></pre>
<p>If the user has access to the licdm subdomain, a cookie is set noting such and does so on the cdn.awwni.me domain. Since these users were now marked, this information can be used in nginx to reroute the user.</p>
<pre><code class="lang-nginx"><span class="hljs-attribute">if</span> (<span class="hljs-variable">$host</span> != licdn.awwni.me) {
    <span class="hljs-attribute">set</span> <span class="hljs-variable">$useCdn</span> <span class="hljs-string">"P"</span>;
}

    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$http_cookie</span> <span class="hljs-regexp">~* 'use_cdn')</span> {
    <span class="hljs-attribute">set</span> <span class="hljs-variable">$useCdn</span> <span class="hljs-string">"<span class="hljs-variable">${useCdn}</span>C"</span>;
}

<span class="hljs-attribute">if</span> (<span class="hljs-variable">$useCdn</span> = PC) {
            <span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/(.*)</span> http://licdn.awwni.me/<span class="hljs-variable">$1</span> <span class="hljs-literal">permanent</span>;
}
</code></pre>
<p>Getting around nginx&#39; inability to do multiple conditionals in one line aside, the above checks to make sure that the cookie is set and that the user is <em>not</em> coming from the licdn.awwni.me domain. That last bit was added when I accidentally set the CDN cookie on licdn and got caught in an infinite redirect loop for a while. If either of the conditions aren&#39;t met, the image will just serve out of my machine.</p>
<p>There are a few drawbacks to this approach. First of all, every request still hits my machine, so I&#39;m still taking a bandwidth hit. Secondly, those getting served out of the CDN have an extra hop for the redirect. However, I believe neither of these issues are bad enough to warrant removing it completely. For starters, on my side I&#39;m now only serving a handful of bytes as opposed to millions. Secondly, a redirect on a single image is pretty much inconsequential to the user&#39;s experience.</p>
<p>I&#39;ve only been running with this solution for a few hours, so I don&#39;t yet have a good look on how great the benefits are. Time will tell on that one, but I haven&#39;t yet heard any issues on images not loading, so there&#39;s some comfort.</p>
</div></article><article class="post"><header class="post__header"><h1 class="post__title"><a href="http://staticr.dxprog.com/entry/my-god-i-am-a-creepy-person">My God, I am a creepy person</a></h1><time class="post__published">February 15, 2014</time></header><div class="post__content"><p>I have this personal website, which essentially means I am my own little mini NSA. If I wanted to, for example, find out if a person I have very few details on were to visit here, I&#39;d be able to find that out. Let&#39;s say, for example, I know what probable day they&#39;d view this blog, what page they&#39;d be coming from, and approximately where they live.</p>
<p>Well, I have enough data to know (probably) if that person hit my site and what they did when they got here.</p>
<p>As a hypothetical example, let&#39;s say I know they&#39;re somewhere in Northern California, probably came to the homepage via a Google search, and did so on February 13th. Alright, first thing&#39;s first, grep the logs for that day, that page, and exclude crawlers...</p>
<p>Sweet, now I have a list of IPs. Let&#39;s plug those into <a href="http://www.maxmind.com/en/geoip_demo">MaxMind geoip lookup</a> and see what comes of it.</p>
<p>Hmm, no exact match, but ISPs are fuzzy about location and this one is certainly within the area! Alright, now grep the logs for that IP address...</p>
<p>Okay, the person was on the homepage for about three seconds before going to the art page. Once there, they clicked on <a href="http://dxprog.com/uploads/Vesperia-Doll.jpg">three</a> <a href="http://dxprog.com/uploads/Kagami_Doll.jpg">pieces</a> of <a href="http://dxprog.com/uploads/HanakoChristmas.jpg">art</a> before leaving the site. All in all, about a minute of time elapsed between the first and final requests.</p>
<p>Other fun things you can find out while grepping logs is that your mother and former boss are the most frequent visitors to your site. The latter - going under a pseudonym - even listened to the Inception soundtrack on your music page sometime back in November while at work.</p>
<p>This is, of course, all hypothetical.</p>
</div></article><article class="post"><header class="post__header"><h1 class="post__title"><a href="http://staticr.dxprog.com/entry/systems-architecture-in-the-unknown">Systems Architecture in the Unknown</a></h1><time class="post__published">January 29, 2014</time></header><div class="post__content"><p>Just over a year ago, I launched <a href="http://redditbooru.com">redditbooru</a> to the world, rolling together a bunch of ideas spawned by the <a href="http://dxprog.com/entry/a-cute-world-of-programming-possibilities/">awwnime repost checker</a> into a single place. In addition to that, I added the ability for users to host content in addition to being able to index multiple subreddits. To say that it became a wild success would almost be selling it short. At launch, it was indexing maybe 5 subs, now it&#39;s 16, my server went from averaging ~23/Kbps per month to over 10/Mbps, and am nearing 100k pageviews for a rolling 30 day period. Despite exponential growth in traffic, the site has experienced almost no traffic related issues proving that my code is able to handle scale. What started off as a fun little afternoon of experimenting has become quite a success.</p>
<p>However, things are not without their flaws. On the technical side, the cron that does the indexing has some issues; items hosted through redditbooru can&#39;t be posted to more than one sub and indexed in both places and sometimes, in an attempt to pick up on items removed by mods, posts will be incorrectly marked as hidden. On the front end, the user experience is a bit of a mess as I kept bolting on features. In typical Matt Hackmann fashion, I decided that I would rework the entire thing mostly from the ground up with all of my learnings in mind while adding in some user requests. But, I was going to eschew the tried and true PHP/MySQL setup for nodejs/MySQL/mongodb in an attempt to learn something new and bring myself up to speed with the current development fad.</p>
<p>Two weeks into development, I am questioning that decision.

<p><a href="http://staticr.dxprog.com/entry/systems-architecture-in-the-unknown">Continue Reading</a></p></div></article><article class="post"><header class="post__header"><h1 class="post__title"><a href="http://staticr.dxprog.com/entry/anime-reviews-2013-it-builds-character">Anime Reviews 2013 - It Builds Character</a></h1><time class="post__published">January 18, 2014</time></header><div class="post__content"><p>We&#39;re leisurely sauntering towards the finish line this year. Will we make it to the end? Maybe. But, as for today, here are the best/worst characters of 2013.</p>
<h2 id="best-characters">Best Characters</h2>
<p><img src="http://cdn.awwni.me/mzjz.jpg" alt="" title="The bokeh comes for free">
<strong>Chris - Yutaka Hasebe (Servant x Service)</strong>
When I first started watching Servant x Service, I honestly expected the characters to be set in stone in the first episode, staying as largely unchanged archetypes as the show progressed. This largely holds true for most of the characters, but there is an exception - Yutaka Hasebe.</p>
<p>His character starts out relatively one-dimensional, seemingly just a persistently happy, lazy bum with a penchant for collecting girls phone numbers. A pleasant enough bloke, as it stands. However, during the show&#39;s progression, you see that there is more to him than meets the eye, especially as you see him attempt to open up to Lucy about his feelings for her.</p>
<p>This blew my mind, as here we had a really fun, likable character with believable development, something that&#39;s almost unheard of in these sorts of slice of life shows. It really makes me want a second season just so I can see how he continues to develop as a character.

<p><a href="http://staticr.dxprog.com/entry/anime-reviews-2013-it-builds-character">Continue Reading</a></p></div></article><article class="post"><header class="post__header"><h1 class="post__title"><a href="http://staticr.dxprog.com/entry/that-which-is-done-annually">That Which is Done Annually</a></h1><time class="post__published">January 3, 2014</time></header><div class="post__content"><p>As is per normal for me, it&#39;s time again to reexamine myself and birth a new Matt Hackmann with the new year. It&#39;s funny how this has become a thing because I used to be vehemently against &quot;New Year&#39;s Resolutions&quot;, taking that stance that a person should be able enact change at any time of the year. But, moreso than that, it&#39;s a barometer to measure how well those changes actually went. Anybody who knows a little bit about statistics knows that you need to monitor trends over time to get the most accurate data. All that said, let&#39;s see how I did against last year&#39;s list.</p>
<p><strong>Health</strong> - To be fair, I actually started out the year pretty well. I all but ceased fast food and was even getting in my daily walking. However, the move to California but a big fat wrench into all that. I write this have just downed half of a Papa John&#39;s pizza. There were some upsides, though, such as the fact that work is within a bikeable distance. Negating anything gained from that, though, was the big uptick in alcohol consumption. It&#39;s amazing how easy it is to drink when there are other people to drink with.</p>
<p><strong>Finances</strong> - Again, the job change had a unique impact on this category. The hard goals I had set out for myself were to reduce superfluous spending and eliminate my LASIK, credit card, and car debts. The middle two I actually accomplished and the car is within reach. However, if anything, the amount of money I dropped on a whim definitely increased, but because of the salary adjustment, I wasn&#39;t hurting as much for it.</p>
<p><strong>Learn Japanese</strong> - I bought the stuff and made absolutely no progress on this at all.</p>
<p><strong>Japan Trip</strong> - Mission accomplished with a repeat trip tentatively planned for 2015.</p>
<p><strong>Drawing</strong> - Pfffffft!</p>
<h2 id="the-2014-version">The 2014 Version</h2>
<p>I&#39;m going to shoot for simplicity this year, so here&#39;s the plan (that I will not follow):</p>
<p><strong>Eat Better</strong> - Again, fast food moratorium (as soon as my Taco Bell gift card is gone and the aforementioned pizza). It&#39;s easy enough to eat healthy at work (portion control being the most difficult part), but this needs to be carried over when I&#39;m not there. Going to have to compile a list of not-terrible-for-me-but-good-for-my-tastebuds recipes.</p>
<p><strong>Bike 150 miles every month</strong> - Once over the initial &quot;three week to develop a habit&quot; hump, this will actually be easy. My round trip work commute is twelve miles, so if I did that five days a week, that&#39;d actually be 200+ miles per month. I&#39;m giving a little bit of slack though. Start slow and all that.</p>
<p><strong>The Girlfriend Factor</strong> - I&#39;ve been single long enough. Time to push past my shyness and make that shit happen.</p>
<p>All in all, I&#39;d say two of those three things is attainable. We&#39;ll see what things are looking like when I write this post again next year.</p>
</div></article><div class="paging"><a href="http://staticr.dxprog.com/archives/11.html" class="paging__link paging__link--next">Earlier Posts</a><a href="http://staticr.dxprog.com/archives/9.html" class="paging__link paging__link--previous">Later Posts</a></div></section><footer class="footer"><p class="footer__copyright">Copyright © 2018 Matt Hackmann</p></footer></section></body></html>